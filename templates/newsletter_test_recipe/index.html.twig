{% extends 'base.html.twig' %}

{% block body %}

	<div class="container1 row row-cols-1 row-cols-sm-2 row-cols-lg-3 g-4 m-auto list"></div>

	<div class="container2 h-50 border m-auto">
		<div class="searchBar text-center">
			<input type="search" name="search" id="searchRecipe">
			<button class="btn btn-success" type="submit" id="submit">Rechercher</button>
		</div>

		<div class="row row-cols-1 row-cols-sm-2 row-cols-lg-3 g-4 m-auto list">
			{% for recipe in recipes %}
				<div class="col">
					<div class="card mb-5 bg-body-tertiary rounded-4 image">
						<img src="{{vich_uploader_asset(recipe, 'imageFile')}}" class="card-img-top" alt="image de la recette">
						<div class="card-body overflow-hidden">
							<h5 class="card-title text-center text-justify fs-5 text-success">{{recipe.name}}</h5>
							<p class="card-text">{{recipe.description}}</p>
						</div>
						<div class="d-flex justify-content-between info">
							{% for season in recipe.seasons %}
								<p class="saison">{{season.name}}</p>
								<i class="fa-solid fa-heart text-success"></i>
							{% endfor %}

						</div>
					</div>
				</div>
			{% endfor %}
		</div>
	</div>

	<script>
		const cards = document.querySelectorAll('.card');
		const cardToCopy = document.querySelectorAll('.col')
		const destination = document.querySelector('.container1')

		const input = document.getElementById('searchRecipe')
		const btnSearch = document.getElementById('submit')

		input.addEventListener('keyup', searchRecipe)
		btnSearch.addEventListener('click', searchRecipe)

		function searchRecipe(event) {
		const inputValue = input.value.toLowerCase()
			
		cards.forEach((card) => {
			const title = card.querySelector('h5').textContent.toLowerCase();
		if(title.includes(inputValue)) {
			card.style.display = "";
		} else { 
			card.style.display = "none";
		}
		})
		}


		cards.forEach((_, i) => {
		const copyCard = cardToCopy[i].cloneNode(true)

		cards[i].addEventListener('click', cardClick)

		function cardClick() {
			destination.appendChild(copyCard)
			
			copyCard.addEventListener('click', cardUnclick, {once : true})
		}

		function cardUnclick() {
				destination.removeChild(copyCard)
			}

		})



	</script>

{% endblock %}
